{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nconst box = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\nconst gallery = document.querySelector('.gallery');\n\nexport function fetchGallery(arr) {\n  gallery.insertAdjacentHTML('beforeend', createGallery(arr));\n\n  box.refresh();\n}\n\nfunction createGallery(arr) {\n  return arr.hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `<li class=\"gallery-item\">\n\t\t\t\t\t<a class=\"gallery-link\" href=\"${largeImageURL}\">\n\t\t\t\t\t\t<figure class=\"gallery-figure \">\n\t\t\t\t\t\t\t<img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\">\n\t\t\t\t\t\t\t\t\t<ul class=\"img-wrap\">\n\t\t\t\t\t\t\t\t\t<li>Likes<span>${likes}</span></li>\n\t\t\t\t\t\t\t\t\t<li>Views<span>${views}</span></li>\n\t\t\t\t\t\t\t\t\t<li>Comments<span>${comments}</span></li>\n\t\t\t\t\t\t\t\t\t<li>Downloads<span>${downloads}</span></li>\n\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</figure>\n\t\t\t\t\t</a>\n\t\t\t\t</li>\n\t\t`\n    )\n    .join('');\n}\n\nexport function fetchLoad() {\n  gallery.insertAdjacentHTML(\n    'beforeend',\n    `<div class='loader-wrapper'>\n        <div class='loader'></div>\n    </div>`\n  );\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\nimport { fetchLoad } from './render-functions';\n\nconst messages = {\n  info: `Please enter a value in the search field!`,\n  endOfSearch: `We're sorry, but you've reached the end of search results.`,\n  warning: `Sorry, there are no images matching your search query. Please try again!`,\n  error: `Sorry, there are no connection to the server. Please try again later!`,\n  exception: `Exception: We have some issue with connection. Please try again later!`,\n};\n\nconst messagesBgColor = {\n  green: '#14b454',\n  yellow: '#e52a2a',\n  red: '#e5c32a',\n};\n\nconst typeEvent = {\n  click: 'click',\n  submit: 'submit',\n};\n\nfunction showMessage(message, color) {\n  iziToast.info({\n    position: 'topRight',\n    backgroundColor: `${color}`,\n    message: `${message}`,\n  });\n}\n\nexport { typeEvent, messages, messagesBgColor, showMessage };\n\nconst API_KEY = '46849284-22f4e981648a1afff2e3fd4a3';\nconst API_URL = 'https://pixabay.com/api/?';\nconst configuration = {\n  params: {\n    key: API_KEY,\n    image_type: 'photo',\n    orientations: 'horizontal',\n    safesearch: true,\n    page: 1,\n    per_page: 15,\n  },\n};\n\nexport async function getGallery(queryValue, page) {\n  try {\n    fetchLoad();\n    configuration.params.page = page;\n    configuration.params.q = queryValue;\n    const response = await axios.get(API_URL, configuration);\n    return response.data;\n  } catch (error) {\n    if (error.response) {\n      const { data } = error.response;\n      showMessage(\n        `${messages.exception} ERROR: ${data}`,\n        messagesBgColor.yellow\n      );\n    } else if (error.request) {\n      showMessage(\n        `${messages.exception} ERROR: ${error.request}`,\n        messagesBgColor.yellow\n      );\n    } else {\n      showMessage(\n        `${messages.exception} ERROR: ${error.message}`,\n        messagesBgColor.yellow\n      );\n    }\n  }\n}\n","import iziToast from 'izitoast';\nimport {\n  typeEvent,\n  messages,\n  messagesBgColor,\n  showMessage,\n} from './js/pixabay-api';\nimport { getGallery } from './js/pixabay-api';\nimport { fetchGallery } from './js/render-functions';\n\nlet eventType = '';\nlet stringQ = '';\nlet actualPage = 1;\n\nconst maxImage = 15;\n\nconst gallery = document.querySelector('.gallery');\nconst form = document.querySelector('.search-form');\nconst loadBtn = document.querySelector('.load-more-btn');\n\nform.addEventListener('submit', onSubmitForm);\n\nloadBtn.addEventListener('click', async () => {\n  try {\n    eventType = typeEvent.click;\n    await renderGallery(stringQ, actualPage);\n    const item = document.querySelector('li');\n    const { height } = item.getBoundingClientRect();\n    scroll(height * 2, 0);\n  } catch (error) {\n    showMessage(messages.exception + error, messagesBgColor.yellow);\n  }\n});\n\nasync function onSubmitForm(evt) {\n  try {\n    evt.preventDefault();\n\n    const target = evt.target;\n    const search = target.elements.search.value.trim();\n\n    eventType = typeEvent.submit;\n\n    loadBtn.classList.remove('visible');\n\n    iziToast.destroy();\n\n    if (stringQ !== search || eventType === typeEvent.submit) {\n      gallery.innerHTML = '';\n      stringQ = target.elements.search.value.trim();\n      actualPage = 1;\n    }\n\n    if (!search) {\n      showMessage(messages.info, messagesBgColor.green);\n      gallery.innerHTML = '';\n      return;\n    }\n\n    await renderGallery(stringQ, actualPage);\n\n    target.reset();\n  } catch (error) {\n    showMessage(messages.exception + error, messagesBgColor.yellow);\n  }\n}\n\nasync function renderGallery(searchValue, page) {\n  try {\n    if (searchValue === stringQ && eventType === typeEvent.click) {\n      actualPage += 1;\n      page += 1;\n    }\n\n    const galleryData = await getGallery(searchValue, page);\n\n    removeLoad();\n\n    if (validateGallery(galleryData)) {\n      const restImages = Math.round(galleryData.totalHits / page);\n      fetchGallery(galleryData);\n      showBtn(restImages);\n    }\n  } catch (error) {\n    showMessage(messages.exception + error, messagesBgColor.yellow);\n  }\n}\n\nfunction scroll(x = 0, y = 0) {\n  window.scrollBy({ top: x, left: y, behavior: 'smooth' });\n}\n\nfunction removeLoad() {\n  const loadWrap = document.querySelector('.loader-wrapper');\n  loadWrap.remove();\n}\n\nfunction validateGallery(galleryData) {\n  if (!galleryData) {\n    gallery.innerHTML = '';\n    return false;\n  } else if (galleryData && galleryData.totalHits === 0) {\n    showMessage(messages.warning, messagesBgColor.red);\n    gallery.innerHTML = '';\n    return false;\n  } else {\n    return true;\n  }\n}\n\nfunction showBtn(imagesCount) {\n  if (imagesCount <= maxImage) {\n    loadBtn.classList.remove('visible');\n    showMessage(messages.endOfSearch, messagesBgColor.green);\n    return;\n  }\n  loadBtn.classList.add('visible');\n}\n"],"names":["box","SimpleLightbox","gallery","fetchGallery","arr","createGallery","webformatURL","largeImageURL","tags","likes","views","comments","downloads","fetchLoad","messages","messagesBgColor","typeEvent","showMessage","message","color","iziToast","API_KEY","API_URL","configuration","getGallery","queryValue","page","axios","error","data","eventType","stringQ","actualPage","maxImage","form","loadBtn","onSubmitForm","renderGallery","item","height","scroll","evt","target","search","searchValue","galleryData","removeLoad","validateGallery","restImages","showBtn","x","y","imagesCount"],"mappings":"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"}